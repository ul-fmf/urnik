{% extends 'osnova.html' %}
{% block content %}

<form action="{% url 'sestavljen_urnik' %}">
<div class="container">
<div class="row">
  <div class="oznaci-vec">
    {% if izbira %}
      <button class="btn-flat" href="#!"><i class="material-icons left">playlist_play</i>prika탑i</button>
    {% else %}
      <a class="btn-flat" href="{% url 'zacetna_stran' %}?izbira"><i class="material-icons left">playlist_add_check</i>ozna훾i
        ve훾</a>
    {% endif %}
  </div>  <!-- oznaci vec -->
  {% for letniki in stolpci_smeri %}
    <div class="col s6 m3">
      <table class="highlight">
        {% regroup letniki by smer as smeri_list %}
        {% for smer_l in smeri_list %}
          <thead>
          <tr>
            <th>{{ smer_l.grouper }}</th>
          </tr>
          </thead>
          <tbody>
          {% for letnik in smer_l.list %}
            <tr>
              <td class="padded">
                {% if izbira %}
                  <input type="checkbox" name="letnik" value="{{ letnik.id }}" id="letnik-{{ letnik.id }}"/>
                  <label for="letnik-{{ letnik.id }}">{{ letnik.leto }}</label>
                {% else %}
                  <a href="{% url 'urnik_letnika' letnik.id %}">{{ letnik.leto }}</a>
                {% endif %}
              </td>
            </tr>
          {% endfor %}
          </tbody>
        {% endfor %}
      </table>
    </div>  <!-- smeri -->
  {% endfor %}
  <div class="col s6 m2">
    <table class="highlight">
      <thead>
      <tr>
        <th>U훾ilnica</th>
      </tr>
      </thead>
      <tbody>
      {% for ucilnica in ucilnice %}
        <tr>
          <td class="padded">
            {% if izbira %}
              <input type="checkbox" name="ucilnica" value="{{ ucilnica.id }}" id="ucilnica-{{ ucilnica.id }}"/>
              <label for="ucilnica-{{ ucilnica.id }}">{{ ucilnica.oznaka }}</label>
            {% else %}
              <a href="{% url 'urnik_ucilnice' ucilnica.id %}">{{ ucilnica.oznaka }}</a>
            {% endif %}
            <small>
              {% if ucilnica.tip == ucilnica.RACUNALNISKA %}
                <i class="tiny material-icons">computer</i>
              {% elif ucilnica.tip == ucilnica.PRAKTIKUM %}
                <i class="tiny material-icons">build</i>
              {% endif %}
              ({{ ucilnica.velikost|default:'?' }} mest)
            </small>
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div> <!-- ucilnice -->
  <div class="col s6 m4">
    <table class="highlight">
      <thead>
      <tr>
        <th>Oseba
          {% if not izbira %}
            <div id="search-osebe-wrapper">
              <input type="text" id="search-osebe" class="autocomplete" title="search"><i class="material-icons">search</i>
            </div>
          {% endif %}
        </th>
      </tr>
      </thead>
      <tbody>
      {% for oseba in osebe %}
        <tr>
          <td class="padded">
            {% if izbira %}
              <input type="checkbox" name="oseba" autocomplete="off" value="{{ oseba.id }}" id="oseba-{{ oseba.id }}"/>
              <label for="oseba-{{ oseba.id }}">{{ oseba.ime }} <strong>{{ oseba.priimek }}</strong></label>
            {% else %}
              <a href="{% url 'urnik_osebe' oseba.id %}">
                {{ oseba.ime }} <strong>{{ oseba.priimek }}</strong>
              </a>
            {% endif %}
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>  <!-- osebe -->
</div> <!-- row -->
</div> <!-- container -->
</form>
{% endblock content %}

{% block footer %}
  {% if not izbira %}
    <script>
        var osebe_urls = {
            {% for oseba in osebe %}"{{ oseba.ime }} {{ oseba.priimek }}":
                "{% url 'urnik_osebe' oseba.id %}",{%  endfor %}
        };

        $(document).ready(function () {
            $('#search-osebe').autocomplete({
                data: {
                    {% for oseba in osebe %}"{{ oseba.ime }} {{ oseba.priimek }}": null,{% endfor %}
                },
                limit: 10, // The max amount of results that can be shown at once. Default: Infinity.
                onAutocomplete: function (val) {
                    window.location = osebe_urls[val];
                }
            });
            $('#search-osebe').focus(function() {
               this.value = "";
            });
        });
    </script>
  {% endif %}
{% endblock footer %}